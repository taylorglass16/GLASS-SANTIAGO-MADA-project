---
title: "Global Distribution of Unintended Pregnancies and Contraceptive Usage"
subtitle: ""
author: Taylor Glass and Aryln Santiago
date: "`r Sys.Date()`"
format:
  docx:
    toc: false
    number-sections: true
    highlight-style: github
bibliography: ../../assets/dataanalysis-references.bib
csl: ../../assets/apa.csl
---

```{r, echo=FALSE, message=FALSE}
# load a few R packages for rendering 
library(here) # for locating tables and figures
library(readr) # for loading tables and figures
library(knitr) # for displaying tables and figures 
library(dplyr) # for basic syntax
```

# Summary/Abstract
Our study investigates the association between unintended pregnancy rates and short-acting reversible contraception (SARC) use across low- and middle-income countries. Data from the Guttmacher Institute's Adding It Up project was used, which included information on reproductive-aged women (15-49) and various demographic factors. Single and multivariate linear regression models were employed to examine relationships between predictor variables and the outcome variable, percentage of unintended pregnancies among SARC users.

The exploratory data analysis revealed a less skewed distribution of unintended pregnancies among SARC users compared to other contraceptive methods. This led the researchers to focus on SARC use for the remainder of the study. Exploratory graphs with the region predictor showed that the Latin America/Caribbean region displayed the strongest association with percentage of unintended pregnancies, followed by Asia. The Oceania and Europe region had weaker associations. Marriage status, both currently and never married, was inversely associated with percentage of unintended pregnancies. As the percent of women who are currently married or never married increases, the percentage of unintended pregnancies decreases. Maternal mortality rates showed a positive correlation with the outcome.

A full model incorporating five predictors, total SARC users, region, marital status, and maternal mortality rates due to unintended pregnancy and abortion, was chosen as the ideal model for this data. Despite performing the best among the evaluated models and being validated through cross-validation and the bootstrap method, the full model exhibited tendencies towards overfitting the data.

Lasso regression, a technique that performs variable selection, was employed to address these overfitting concerns. The analysis identified the total number of SARC users as the strongest predictor, followed by region. Marital status and maternal mortality rates displayed weaker negative associations with unintended pregnancy rates. While the direction of the association between abortion-related maternal mortality and unintended pregnancy rates flipped in the Lasso model, the coefficient that represents the effect size remained minimal.

Overall, this study highlights the influence of regional variations, short acting reversible contraception use, and marital status on unintended pregnancy rates in low- and middle-income countries. The findings suggest a need for further investigation into the factors influencing maternal mortality rates and unintended pregnancies.


{{< pagebreak >}}


# Introduction 

## General Background Information

We will be looking for patterns in contraceptive methods and unintended pregnancies across all age groups (15-19, 20-24, 25-35, and 35-49) to investigate the effectiveness of three contraceptive methods: long acting reversible and sterilization,short acting reversible, and traditional. Financial, social, religious, and cultural factors are current challenges against efforts towards reducing unintended pregnancies [@jonathanmarcbearakCountryspecificEstimatesUnintended2022]. According to a cross-sectional survey done in 2017, contraceptive use was prevalent among women who had attained higher education, were in stable partnerships, and identified with the dominant ethnic group. Additionally, factors like previous pregnancies and immigration status did not appear to influence contraceptive use in this study [@rivetContraceptionUseAttitudes2021]. African and Latin American/Caribbean countries have the highest percentages of unintended pregnancies. This could be due to the current legal status of contraception within Latin American countries. All Latin American have ratified international agreements that recognize a woman's right to privacy, health, and control over her reproductive choices. However, the legal status of contraception varies greatly by country. Chile, Colombia, and Ecuador legally recognize access to emergency contraception, while Nicaragua and Bolivia rely on legal protocols. In 2008, the Chilean Constitutional Court argued against the legal principle of “giving preference to an interpretation that favors the right of ‘a person’ to life above any other interpretation that may annul such a right.”[@heviaLegalStatusEmergency2012] This decision permitted the use of emergency contraception. Argentina and Brazil lack legal recognition of emergency contraception but offer protocols and guides as part of the “Obligatory Medical Program”. Mexico requires provision of emergency contraception to victims of sexual and domestic violence. Contrastingly, in 2009, Honduras issued a complete ban on the distribution of emergency contraception. [@heviaLegalStatusEmergency2012]. It is important to note that judges are not responsible for examining scientific evidence before making a legal decision. It has been observed that stable contraceptive use among high-risk women suggests reaching even lower national unintended pregnancy rates might be challenging. [@kavanaughContraceptiveMethodUse2018].


## Description of data and data source
The data source for this project is the Guttmacher Institute, which is a well-known research organization focusing on improving sexual and reproductive health around the world. The data used here is from their Adding It Up project. The goals of this project include estimating the need for, impact of, and costs associated with providing sexual and reproductive health services. Low and middle income countries are the target audience for this research, specifically women of reproductive age (15-49). Some of the variables included in this dataset are modern contraceptive use, unintended pregnancies, unplanned births, and abortions averted. Observations are drawn from nationally representative surveys, including Demographic and Health Surveys, UNICEF Multiple Indicator Cluster Surveys, US Centers for Disease Control Reproductive Health Surveys, Performance Monitoring for Action Surveys, and others. The UN Population Division is the source of population projections for women in this age group, and estimates of unintended pregnancies are from the Guttmacher Institute, WHO, and other authors, which have been adjusted to 2019.

It is important to note the types of contraception included in each category defined by the Adding It Up project. Permanent methods include female and male sterilization, and long acting methods include intrauterine devices (IUDs) and implants. These methods are combined for several variables and include a 'larcster' prefix or suffix to identify them throughout the dataset. Short-acting methods include hormonal pills, injectables, male and female condoms, emergency contraceptive pills, patches, rings, diaphragms, vaginal spermicide, and other supply methods, which is denoted with a 'sarc' prefix or suffix in the variable name. Traditional methods include periodic abstinence, withdrawal, abstinence, and breast-feeding, which is denoted with a 'trad' prefix or suffix.   

For the purpose of this project, we chose several numeric variables from the data source: percentages of pregnancy outcomes, rates of safe and unsafe abortions, and percentage of various contraceptive usages. There are only three character variables that can be used to group the numeric variables: country name, region, and sub region. 

## Questions/Hypotheses to be addressed

Is there a significant difference in the percentage of unintended pregnancies among short acting reversible contraception users between the five regions included in the Adding It Up project? 

The main outcome variables will be total percentage of unintended pregnancies among women using short acting reversible contraception methods (`pct_upreg_sarc`).

The predictor variables will include the total number of women using each type of birth control standardized by population size, region, percentage of women currently married, percentage of women never married, total rate of maternal deaths, rate of maternal deaths due to unintended pregnancy and rate of maternal deaths due to abortion. 
    
A full list of variables can be found in the `processing-file.qmd` in the code > processing-code folder. 

We hypothesize that the percentage of unintended pregnancies among SARC users will vary between the five regions based on differing access to this type of contraception. 

{{< pagebreak >}}


# Methods 
Reproducing this project requires R, RStudio, and Microsoft word. The README files in each folder contain descriptions of the documents located in that folder to help guide users through the reproducible processes. Begin with the processing-file.qmd in the code > processing-code folder. This file loads the original dataset from the Guttmacher Institute's Adding It Up project, loads the codebook for the dataset, and glimpses at the data. We chose 30 variables to clean to find the percentage of unintended pregnancies based on each type of contraceptive methods: long acting reversible and sterilization methods, short acting reversible methods, traditional methods, and no contraceptive usage. After the missing data was explored, we chose to use the percentage of unintended pregnancies variables related to each method of birth control because the total variable had unexplained missing data. The processed data is saved in the data > processed-data folder as `processeddata.rds`. 

The next step is exploratory data analysis. The eda.qmd file in the code > eda-code folder contains all the code for this process. We produced a couple summary tables before we began a simple exploration of trends in percentage of unintended pregnancies by country in our first set of histograms. The second set of histograms explore contraceptive usage methods by country. These graphs revealed outliers, so we standardized by population size for each country. The next sets of plots are scatter plots showing total usage of contraceptive methods and percentage of unintended pregnancies associated with that method. The last two sets of plots contain scatter plots of the relationship between the two variables stratified by region and violin plots displaying the relationship between percentage of unintended pregnancies and the categorical usage variable created during processing. All of these figures are displayed and summarized in the `Supplementary-Material.qmd` file in the products > manuscript > supplement folder. This process led us to focus on the percentage of unintended pregnancies among short acting reversible methods users as our single outcome because this method covers the most commonly used types of contraception, so we feel that results from this contraception method will be the most relevant. Additionally, the exploratory data analysis process showed that the distribution of this outcome variable is less skewed than the other options, and the stratification by region is clearer, which allows for better understanding. All exploratory figures are saved in the results > figures > exploratory-figures folder. 

Step three is the statistical analysis and model fitting portion found in the `statistical-analysis.qmd` file in the code > analysis-code folder. We explore the single outcome `pct_upreg_sarc` based on 7 predictors: total number of women using short acting reversible methods, region, percent of currently married women, percent of women who never married, total rate of maternal mortality, rate of maternal mortality by unintended pregnancy, and rate of maternal mortality by abortion. We utilize simple linear regression and multiple linear regression with various combinations of the 7 predictors. Result tables for each model and test are stored in the results > tables folder. 

Step four is to critically analyze the performance of our models to determine which one performs the best in predicting our outcome, which is also done in the `statistical-analysis.qmd` file in the code > analysis-code folder. We chose 2 performance metrics to find for each of our 9 models: Root Mean Square Error (RMSE) and Mean Absolute Error (MAE). Once we decided on the final model based on RMSE and MAE, we use cross-validation to determine how well it will performs on data it has not seen before. This involves splitting the data into testing and training pieces, which allows for comparison of the predictions created using both datasets. To examine the uncertainty in the model, we used the bootstrapping method to resample our data 100 times to find confidence intervals for our predictions. Next, we used a LASSO regression to add a penalty to each parameter included in the model to determine if any variables should be removed to improve model performance. It is important to tune the hyperparameters associated with LASSO regression to determine which model fits best. We used a grid search to ensure that all combinations of the parameters in our grid are considered. Lastly, we added a random forest model to attempt to improve model performance further. We used another parameter tuning grid to allow for cross-validated tuning of 2 variables: `mtry`, the number of variable to possibly split at in each node, and `min_n`, the minimal node size. Each of these processes are crucial in determining which model performed best for our data. Result tables for each model and test are stored in the results > tables folder. Figures created from cross-validation, bootstrapping, LASSO regression, and random forest modeling are stored in the results > figure > final-figures folder.

The `Manuscript.qmd` file for this document can be found in the products > manuscript folder. 

## Data aquisition
This research aims to analyze the factors influencing unintended pregnancies and contraception use in low-and-middle-income countries. The Guttmacher Institute's Adding It Up project provides the foundation, offering data on sexual and reproductive health services in these regions. Focusing on women of reproductive age (15-49), the study uses information from nationally representative surveys and population projections to estimate percentage of unintended pregnancies.

While data on the overall percentage of unintended pregnancies was unavailable, we strategically utilized data on percentages related to specific birth control methods. This approach allows us to analyze the relationship between these percentages and various social and health factors. For example, the number of women utilizing different birth control methods, maternal death rates, and marital status are all meticulously examined. All 7 of these predictor variables were found within the study's codebook, which can can be found in the `data` folder of this project. By discovering these relationships, the research aims to shed light on the complex landscape of contraception use and unintended pregnancy in low-and -middle-income countries. This knowledge can empower policymakers and healthcare providers to make informed decisions that ultimately improve reproductive health outcomes for women.

## Data import and cleaning
As shown in the `processing-file.qmd` in the code > processing-code folder, the data is imported from a .csv file that was downloaded directly from the Guttmacher AIU project website. The codebook is also included in this file. After taking a glimpse at the data, we identified the variables that need to be cleaned and created a new dataset with those variables only. We explored missingness in the data, which is further explained in the `supplementary-material.qmd` file found in the products > manuscript > supplement folder. Simple processing tasks include converting variable types, converting decimal value into true percentages, creating variables to find total usage of each birth control method across age groups, exploring outliers, and creating new standardized total usage values based on population size.  

## Statistical analysis
We began with a simple linear regression model with each of the 7 predictor variables to determine the association between each variable and the outcome. We explored the `region` variable further because our main research question is to understand the difference in outcome by region. This led to discovering correlations between some of the predictors, which we examined through correlation coefficients. We tried out a combination of these correlated predictors in 2 different models to further examine the interactions. After considering which predictors are most impactful on our outcome, we narrowed the final predictors down to a list of 5. We included a multiple linear regression model with all 5 of these predictors. We used the RMSE and MAE performance metrics to evaluate all 10 models that we created to determine which one fit best, including the null model with no predictors to serve as a comparison. Lastly, we used cross-validation to determine how well our multiple linear regression model performs on data it has not seen before. We also used LASSO regression and random forest modeling as forms of subset selection by applying a regularization penalty and generating a tree structure, respectively. Lastly, we examine the AIC values associated with our two best performing models. 

{{< pagebreak >}}


# Results

## Exploratory/Descriptive analysis

After deciding on a single outcome variable, we created a summary table with that outcome and the seven predictors we used to predict it, which can be seen in @tbl-1. Based on the summary table below, it appears that the region with the highest rate of unintended pregnancies due to SARC usage is Latin America/Caribbean at 24%, followed by Europe at 23%. Africa and Asia have a mean of 13% and 14% respectively, while Oceania appears to have the lowest rate at 6%. It appears that a higher percentage of women are currently married in Asia (66%) and Africa (60%) compared to Latin America/Caribbean (54%) and Oceania (60%).The average percentage of never married women across the 5 regions is 31%. Latin America/Caribbean region has the highest percentage of never married women at 35%, and the Asia region has the lowest percentage of never married women at 29%. Rates of maternal death are much higher in Africa with an average total rate of maternal deaths due to unintended pregnancies of 1,656 per 100,000 live births. The Asia region experiences the second highest rate in this category with 701 maternal deaths due to unintended pregnancies per 100,000 live births. 
```{r}
#| message: false
#| label: tbl-1
#| tbl-cap: "Summary of All Explored Variables"
#| echo: FALSE
predictortable<- readRDS(here("results", "tables", "predictortable.rds"))
predictortable
```

We created a multitude of exploratory plots to understand our data better. The first exploratory result shown in @fig-1 displays the distribution of the outcome variable: percent of unintended pregnancies due to short acting reversible methods. The `pct_upreg_sarc` variable is slightly skewed to the right with an average around 12%.
```{r}
#| message: false
#| label: fig-1
#| fig-cap: "This bar chart showcases the frequencies of the number of countries and the percentage of unintended pregnancies using SARC methods. The data presented suggests that there are fewer countries with a higher number of unintended pregnancies using SARCs considering more than half of the countries experience less than 20% of unintended pregnancies when using SARCs."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "exploratory-figures", "pctupreg_sarc_distribution.png"))
```

The next set of variables we explored were the total counts of women using each birth control method. There were two large outliers that prevented the graphs from being useful. After exploring the outliers, we standardized using the population size of reproductive aged women (15-49 years). There is a positive association between the percentage of unintended pregnancies among short acting reversible method users and the total number of women using that method of birth control, which is to be expected. Our outcome variable is the number of unintended pregnancies among women who are using short-acting reversible contraception, so the number of unintended pregnancies that can be classified in this outcome is dependent on the number of women using this type of contraception. This percentage should increase as the number of women using SARCs increases because more women are at risk of experiencing an unintended pregnancy due to this contraception if they are using this type of contraception in the first place. This outcome variable does not speak to the effectiveness of short-acting reversible contraception, so it makes sense that our outcome would increase as more women put themselves at risk of experiencing the outcome through becoming classified as SARC users. As explained in the supplementary material, the dataset includes the percentage of unintended pregnancies among long-acting reversible contraception and sterilization users, traditional birth control users, and users who do not use a method of birth control. Each of these percentages are positively associated with the number of people in its respective classification group that it represents. The association for the contraception that we chose to focus on for this analysis, SARCs, is displayed in @fig-2.
```{r}
#| message: false
#| label: fig-2
#| fig-cap: "A scatter plot was contructed to examine if there is a correlation between the standardized count of women using SARCs and the percentage of unintended pregnancies among SARC users. In this case, a clear positive correlation is shown. It suggests that as the number of women using SARCs increases (x-axis), the percentage of unintended pregnancies increases (y-axis)"
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "exploratory-figures", "pctupreg_totalsarc.png"))
```

The previous scatter plot is stratified by region to examine how the relationship differs across each of the regions which is shown in @fig-3 . The graph shows clear differences between regions, and Latin America/the Caribbean leads in the percentage of unintended pregnancies in this category, but Africa experiences the sharpest increase in percentage of unintended pregnancies as the total population increases.
```{r}
#| message: false
#| label: fig-3
#| fig-cap: "In this scatter plot, the relationship between the standardized count of women using SARCs and the percentage of unintended pregnancies is examined by region.There appears to be a positive correlation between the standardized count of women using SARCs and the percentage of unintended pregnancies regardless of region, but there is some variation between regions. The regions with the highest percentage of unintended pregnacies are Latin America & the Caribbean, followed by Africa."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "exploratory-figures", "pctupreg_sarc_stratified.png"))
```

Violin plots were created using the categorical SARC usage variable as shown in @fig-4. It appears that the distribution of SAR usage is skewed towards lower percentages of unintended pregnancies across all usage levels, suggesting that more countries have lower percentage of unintended pregnancies among women using this method. The high-usage countries appear to have a bottleneck in percentage of unintended pregnancies. The low-usage countries appear to be skewed towards lower levels of unintended pregnancies among SARC users, but the medium-usage countries appear to have slightly higher percentages of unintended pregnancies. 
```{r}
#| message: false
#| label: fig-4
#| fig-cap: "Violin plots are used to visualize the distribution of data across different categories. In this case, it is being used to see the distribution of unintended pregnancy rates among countries that use short-acting reversible contraceptives (SARCs). This violin plot shows that the distribution of percentage of unintended pregnancies is wider for countries with high SARC usage compared to counties with medium or low SARC usage. This means that there is more variation in unintended pregnancy rates in counties with high SARC usage."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "exploratory-figures", "sarc_pctupreg_violin.png"))
```

Lastly, we explored the predictor variables that will be used in our models. The Africa region accounts for most of the observations with about 53 countries, followed by Asia that includes about 35 countries. Latin America/the Caribbean accounts for about 25 countries. Europe and Oceania account for the least number of observations. The distribution of women currently married is approximately normal with an average around 57% and no major outliers. The distribution of women never married is slightly skewed to the right with an average around 30%, but there are a few outliers greater than 60%. The distribution of the total maternal mortality rate is highly skewed to the right with a couple outliers. We would have expected the highest rates to belong to India and China because they have the most people, but it is Chad, Sierra Leone, and South Sudan that account for the highest rates of total maternal mortality, which each belong to the African region. The distribution of the maternal mortality rate from unintended pregnancies is highly skewed to the right, which is to be expected based on the trend shown in the previous histogram. Chad and South Sudan also account for the highest rates of maternal mortality in this category. The distribution of maternal mortality rate from abortions is also highly skewed to the right. The outliers are accounted for by Gambia and Mauritania in this predictor, which both belong to the African region.


## Basic statistical analysis
We completed a simple linear regression analysis with each of the 7 predictors shown in @tbl-2. The predictor with the strongest positive relationship with the outcome is total number of women using short acting reversible methods (`sarc_standard`). This percentage should increase as the number of women using short acting-reversible contraception increases because more women are at risk of experiencing an unintended pregnancy due to this contraception if they are using this type of contraception in the first place.

```{r}
#| message: false
#| label: tbl-2
#| fig-cap: "Table 2: This simple linear regresion model shows a strong effect of the standardized population size using short-acting reversible contraception methods on the outcome of percentage of unintended pregnancies due to SARCs. This strong positive relationship indicates that as more women use this form of contraception, more women are susceptible to unintended pregancies due to SARCs because they are now at risk of experiencing the outcome. The coefficient of 87.65998 is the largest single coefficient of any predictor studied in this analysis, which increases our confidence in including it as a predictor in our final model."
#| echo: FALSE
readRDS(here("results","tables", "resulttable1.rds")) 
```

The second model we created used the `region` predictor, which revealed that the Latin America/the Caribbean region had the strongest relationship with the outcome variable, followed closely by the Asia region. The Oceania region does not appear to have a strong effect on the outcome variable with the Europe region only showing a slightly larger association. These associations can be seen in @tbl-3.
```{r}
#| message: false
#| label: tbl-3
#| fig-cap: " Table 3: In a simple linear regression with the `region` predictor only, the Latin America/the Caribbean region has the strongest relationship with the outcome based on a coefficient of 1.6 followed closely by Asia. Europe has a smaller efffect on the outcome based on the coefficient of 0.3, but Oceania has the smallest effect on the outcome. This model chose the African region as the reference group, which means that it has the weakest association with the outcome compared to the other 4 regions."
#| echo: FALSE
readRDS(here("results","tables", "resulttable2.rds")) 
```
Details about the 10 different models we created can be found in the statistical-analysis.qmd file in the code > analysis-code folder along with an exploration of the correlation between predictors.

## Full analysis

We created one model with all 5 predictors using multiple linear regression, shown in @tbl-4. This model shows the strongest predictor is the number of women using SARCs. The next strongest predictor is the European region followed by the Latin America/the Caribbean region and the Asia region, which is a shift from the model with the singular `region` predictor. The Oceania region now has a negative association with the outcome. The currently married predictor is associated with a weak decrease in the outcome. The coefficient estimates for the rate of maternal death due to unintended pregnancies and abortion both show a very weak positive association with the outcome. 
```{r}
#| message: false
#| label: tbl-4
#| fig-cap: "Table 4: The multiple linear regression model with all 5 predictors confirms that the `sarc_standard` predictor has the strongest effect on the outcome, but the effect size has decreased slightly. The region variable is the second most impactful predictor, but there is a shift in which region has the strongest effect on the outcome. Africa still serves as the control region, but Europe has the largest effect size in this model followed by Latin America/the Caribbean. Oceania still has the weakest effect, and the effect is negative in this model compared to the positive effect seen in the simple linear regression model with the region predictor. The percent of currently married women, rate of maternal deaths due to uninteded pregnancies, and rate of maternal deaths due to abortion are very weak predictors with miniscule coefficients."
#| echo: FALSE
readRDS(here("results","tables", "resulttable8.rds")) 
```
To determine which model performed the best, we started by examining the RMSE and MAE performance metrics. We found that the model with the standardized total count of women using SARCs performed the best in a single predictor model compared to the percent of currently married women and the rate of maternal mortality due to abortion. @tbl-5 shows the RMSE and MAE values for each of these three models compared to the null model with no predictors. The model with the population size using SARCs is the only single predictor model that performs better than the null. The full model with all 5 predictors performs the best with the lowest RMSE and MAE values. 
```{r}
#| message: false
#| label: tbl-5
#| fig-cap: "Table 5: The performance metric comparisons clearly highlight the full model with 5 predictors as the best model with the lowest RMSE of 4.361363 and lowest MAE of 3.386193. The model with percent of currently married women and the model with the rate of maternal mortality due to abortion only perform slightly better than the null model, which just predicts the average outcome. These models are extremely poor. The best single predictor model is the one with the standard population size using SARCs with an RMSE of 5.143319 and an MAE of 3.953767."
#| echo: FALSE
readRDS(here("results","tables", "resulttable14.rds")) 
```
We used cross-validation of the two best models to determine how well the model performs on data it has not seen yet by splitting the data into testing and training pieces. The cross-validated results, shown in @tbl-6, lead to the same conclusion: the multiple linear regression model with 5 predictors performs better. The RMSE value for the single predictor model with `sarc_standard` is 4.822226, which is lower the the first RMSE value of 5.143319. While the RMSE value for the multiple linear regression model is slightly higher than the first time it was calculated, it is still lower than the single predictor model. Additionally, the standard error of the RMSE for the multiple linear regression model is 0.2768, which is lower than the standard error of the RMSE for the single predictor model of 0.3528. This means there is higher variance in the single predictor model. The R-squared value of 0.8206 for the multiple linear regression model is higher than 0.7861 for the single predictor model, which means the multiple linear regression model accounts for more of the variability in the data. Overall, the multiple linear regression model performs better.
```{r}
#| message: false
#| label: tbl-6
#| fig-cap: "Table 6: Cross-validated (CV) performance metric comparisons were only completed on two models: the single predictor model with the `sarc_standard` variable and the full model with all five predictors because these two models performed the best in the first analysis. The RMSE metrics are closer using the CV technique with a differencec of 0.42 between the two models. The standard error of the full predictor model is slightly higher, but the R-squared value is also slightly higher for the full predictor model. These metrics confirm that the full predictor model is the best choice compared to single predictor models."
#| echo: FALSE
readRDS(here("results","tables", "resulttable15.rds")) 
```

Since we determined that the full model with all 5 predictors performs best, we graphed the predicted versus observed values using this model with both the testing and training data to further examine model performance. As seen in @fig-6, the training model predictions, shown in teal, hover pretty closely around the expected relationship between the outcome and the 5 predictors, which is depicted as the 45 degree line. The testing model predictions, shown in coral, are much more extreme than the training model predictions because they are farther from the 45 degree line. While there is some overlap between the two sets of predictions, it is likely that our model is overfitting the data. 
```{r}
#| message: false
#| label: fig-6
#| fig-cap: "Evaluating the final model performance on test data reveals that the model is strongly overfitting the data. The testing model predictions are shown in coral, and the variation in these observations is much higher compared to the training model predictions, shown in teal. Ideally, there would be complete overlap between the testing and training data predictions following the black dotted line that represents the ideal relationship between observed and predicted values. The majority of testing data predictions do not overlap with the training data prediction in this case, and the testing data predictions are father away from the preferred relationship shown by the black dotted line."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "final-figures", "fullmodelpred.png"))
```
We went one step further to examine the uncertainty in the full model predictions using the bootstrap method with 100 resamples of the training data. The figure shown in @fig-7 displays the 95% confidence intervals, shown as dark blue lines, for the predictions made by the model. The confidence intervals are narrow, which shows there is minimal uncertainty in the model prediction. For the predictions that do not fall on the expected 45 degree line, the confidence intervals do not intersect with the line either. These findings increase the validity of the conclusion that the model is overfitting the data because there is not much uncertainty in the predictions. 
```{r}
#| message: false
#| label: fig-7
#| fig-cap: "Evaluation of uncertainty in the full model predictions reveals decent overlap between the point estimates, shown in black triangles, and the median prediction observation, shown in coral circles. The error bars, shown in blue, represent 95% confidence intervals of the median estimates, and most of the confidence intervals contain the point estimates. This provides confidence in the certainty of the model's predictions, but this is not very meaninful considering how the full model overfits the data."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "final-figures", "bootstrappred.png"))
```

Since we have evidence that our model overfits the data, we explored our full model with Lasso regression to determine if its performance could be improved. This technique could reveal predictors that should not be included in the final model, which could reduce the risk of overfitting. As seen in @tbl-7, the LASSO regression coefficients are much smaller than the first full model we created without the regularization penalty, but all 5 predictors remain in the model. The `sarc_standard` predictor still has the strongest relationship with the outcome. The percent of women currently married, rate of maternal deaths due to unintended pregnancies, and rate of maternal deaths to due to abortion all have weak negative associations with the outcome. This process confirms that the final model should contain all 5 predictors. 
```{r}
#| message: false
#| label: tbl-7
#| fig-cap: "Table 7: LASSO regression results confirm the findings of the multiple linear regression model, but each of the coefficients has been shrunk as a result of the penalty parameter of 0.1. The `sarc_standard` predictor is still the most strongly related to the outcome, followed by the European region. The LASSO penaltty decreased the effect size of the Oceania region even further, and the smallest coefficient is now assigned to the percent of currently married women, which is a shift from the multiple linear regression model. The rates of maternal mortality due to unintended pregnancy and abortion are very weak predictors in this model as well."
#| echo: FALSE
readRDS(here("results","tables", "resulttable16.rds")) 
```
It is important to tune the hyperparameters associated with LASSO regression to determine the model that fits best, which is shown in @fig-8. As the regularization penalty increases past 1, the RMSE value increases exponentially. The lowest RMSE for the model is slightly greater than 5 when the regularization penalty is less than 1. When the regularization penalty increases to 10, the RMSE increases to almost 11. Since we originally chose 0.1 as our penalty parameter, we found one of the best performing models with the LASSO regression based on an RMSE value slightly greater than 5, which i comparable to the RMSE found in the first regression model with all 5 predictors. 
```{r}
#| message: false
#| label: fig-8
#| fig-cap: "Parameter tuning for the LASSO regression reveals that the parameter should be smaller than 1 to ensure the lowest RMSE performance metric value. The RMSE value increases exponentially when the penalty parameter exceeds 1, so this provides confidence in our choice of using 0.1 as the penalty parameter in the prevoiusly displayed LASSO regression model. There is no evidence to use a smaller penalty parameter than 0.1 because it does not result in a lower performance metric."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "final-figures", "lassoparameters.png"))
```

After creating the random forest model as another attempt to immprove model performance, we found that the RMSE and MAE values are exactly the same because the same 5 predictors are used for the outcome, but the R-squared value shows that the random forest model performs slightly better. Since a higher R-squared value represents smaller differences between the observed and predicted values, we can conclude that this model is predicting our outcome with slightly higher accuracy. The plot of the predicted versus observed values shown in @fig-9 displays stronger correlation for predicted values compared to the testing and training done with cross-validation previously.  
```{r}
#| message: false
#| label: fig-9
#| fig-cap: "The graph of predicted versus observed values in the random forest model shows less deviation from the expected relationship visualized by the black dotted line in comparison to the multiple linear regression model displayed previously. While there are still several outliers as the predicted values increase past a value of 20, the observations hover around the expected relationship with conistency for values less than 10. While it is still likely that the random forest model is overfitting because it uses the same predictors, it appears that this model has higher predictive accuracy."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "final-figures", "randomforestpred.png"))
```

Again, it is crucial to tune hyperparameters associated with machine learning models. Based on the red line displayed in @fig-10 that shows the lowest possible RMSE score, our random forest model performs the best with a node size of 1 and 4 predictors. This begs the question of which one of the 5 predictors included in our model should be dropped to improve model performance because all previous performance metrics suggested that including all 5 predictors created the best model. However, there is a minimal increase in RMSE when all five predictors are included in the model, but the results suggest that a full model should have a node size of 4 to achieve the lowest RMSE.
```{r}
#| message: false
#| label: fig-10
#| fig-cap: "After tuning two parameters for the random forest model, it is clear that the best model based on the lowest RMSE performance metric value has a minimal node size of 1 for 4 out of the 5 models. This graph suggests that the final model should contain 4 predictors to achieve the best performance metric, but it does not provide information on which parameter should be dropped from the model. Interestingly, the best model with all 5 predictors has a minimal node size of 4."
#| echo: FALSE
knitr::include_graphics(here("results", "figures", "final-figures", "randomforesttune.png"))
```

As seen in the `statistical-analysis.qmd` file, we created 10 different model options with unique combinations of our 7 predictors. After considering effect sizes and performance metrics for each model, we have decided that the LASSO regression model with 5 predictors is the best overall choice for predicting our outcome of percentage of unintended pregnancies due to SARCs. We used cross-validation with LASSO regression and random forest modeling to explore subset selection of our full model with all 5 predictors. The LASSO regression kept all 5 predictors, and the coefficients for the Asia, Europe, and Latin America/the Caribbean predictors were the largest behind the `sarc_standard` predictor. The smallest coefficient was assigned to the percent of currently married women predictor. 

We suggest using the full model with all 5 predictors with a LASSO regression because it accurately portrays the importance of each predictor while providing a penalty to predictors that do not meaningfully contribute to the model. While this model has a slightly lower R-squared value than the random forest model, the evidence of overfitting is so strong that this difference is negligible. Cross-validation of the model with all 5 predictors showed that predictions from testing data deviated from the expected relationship with larger variance than the predictions from the training data. Since the model did not perform well when used on test data, we conclude that there is overfitting in our model. Unfortunately, it is likely that any of these models are not optimal choices for predicting our outcome based on the poor performance of our model on testing data. While we suggest using the LASSO regression with all 5 predictors to predict our outcome because it is slightly easier to interpret than the random forest model, future researchers who are willing to sacrifice interpretation for predictive power should use the random forest model with 4 predictors based on the slightly higher predictive performance shown by the R-squared performance metric. 

{{< pagebreak >}}


# Discussion

## Summary and Interpretation
Our exploratory data analysis allowed for examination of the distribution of the outcome of interest, percentage of unintended pregnancies due to short acting reversible contraception and the predictors used to describe the outcome. Most low- and middle-income countries were from the African region, followed by Asia and Latin America/the Caribbean. The Latin America/the Caribbean region experienced the highest percentage of unintended pregnancies followed by Europe and Asia. This association is likely explained by the fact that women in these regions have better access to short acting reversible contraception methods because we would have expected the African region to experience the highest rate of our outcome based on the number of countries included from that region. After standardizing the number of women who use SARCs based on total population size, it is clear the women in the Latin America/the Caribbean region use this contraception method at the highest rates, followed by the Asian region. Further analysis of the region predictor in a linear model with the outcome confirmed this finding by showing that Latin America/the Caribbean has the strongest association with the outcome, followed by Asia. Asia accounted for the highest percentage of currently married women. The highest rate of maternal mortality due to abortion and highest rate of maternal mortality due to unintended pregnancies are both accounted for by the African region. This cannot be explained by having the highest number of reproductive age women because the Asian region has 6 times the number of reproductive age women compared to the African region. This discrepancy is likely due to poorer access to maternal healthcare in Africa compared to Asia. 

Our full statistical analysis of the final model with 5 predictors included the standardized number of women using SARCs, region, percent of currently married women, rate of maternal mortality due to abortion, and rate of maternal mortality due to unintended pregnancies as predictors. Cross-validation using LASSO regression and random forest modeling techniques did not result in a meaningful increase in performance metrics, and the model is strongly overfitting the data based on the predicted versus observed outcomes between the testing and training data. Based on the model using LASSO regression, the number of women using SARCs is the strongest predictor, which is to be expected because women must be using this form of contraception to have an unintended pregnancy due to failure of this contraceptive method in the first place. The most influential factor in this model is the `region` variable with European, Asian, and Latin American regions having the strongest effects on the outcome. This finding implies that these three regions have the best access to SARCs because they also have the highest standardized population size using this form of contraception in the first place. Since the African region was always selected as the control for the model, it is likely that this region has the lowest access to SARCs. The percent of currently married women, rate of maternal mortality due to abortion, and rate of maternal mortality due to unintended pregnancies as predictors are all negatively associated with the outcome in this model. This implies that the percentage of unintended pregnancies decreases when a higher percentage of women are currently married and when the country experiences a higher maternal mortality rate based on abortion and unintended pregnancies. However, these effects are so small that it is likely these predictors do not have a real effect on the outcome. This analysis was successful in determining that region does have a significant effect on the percentage of unintended pregnancies due to short acting reversible methods with the Latin America/the Caribbean region experiencing the outcome at the highest rates.

## Strengths and Limitations
There are several limitations for this analysis that must be addressed. First, this study relied on secondary data from the Guttmacher Institute's Adding It Up project. We were limited by the data that was available because we were unable to collect our own data. The study was cross-sectional, which means that it only looked at data from one point in time. This makes it difficult to establish causal relationships between the variables based on lack of information about temporality. The largest limitation of the study is the evidence of overfitting for our final model. While we had solid evidence from performance metrics for choosing this model, it does a fairly poor job of representing the data based on the cross-validated testing and training data predictions. Our recommendation is to explore more variables from the Adding It Up project or additional sources to determine if there are better predictors for this outcome. Since we chose our predictors based on the literature, it is unlikely that there are other predictors that will more accurately predict the percentage of unintended pregnancies due to SARCs. Further research into the other contraceptive methods studied in the Adding It Up project, such as long acting reversible contraception, sterilization, and traditional methods, could provide clarity on the patterns that we discovered in this analysis. Due to limited time and experience, we were not able to examine all 4 of these outcomes in this project. 

Despite these limitations, our study provides valuable insights into the factors influencing unintended pregnancy rates in low- and middle-income countries. We utilize cutting edge machine learning models to test 10 different model options, cross-validate 3 of the best performing models, and tune parameters for LASSO regression and random forest modeling of our final model. These robust techniques allowed for a thorough investigation of predictors and outcomes. Our findings suggest that a multifaceted approach is needed to address unintended pregnancy. This approach should include increasing access to SARC methods, improving education and counseling on contraception use, and addressing regional disparities in access to healthcare services and family planning programs.


## Conclusions
This study investigated the association between unintended pregnancy rates and short-acting reversible contraception (SARC) use across low- and middle-income countries. The findings suggest that SARC use, regional variations, and marital status are all important factors influencing unintended pregnancy rates.

The study found that SARC use was the strongest predictor of unintended pregnancy rates. This suggests that women who rely on SARC methods are more likely to experience unintended pregnancies compared to those who use other contraceptive methods. There are several possible explanations for this finding. First, SARC methods, such as pills and patches, require more frequent user adherence than long-acting reversible contraceptives (LARCs) like implants. Perfect use of SARC methods is essential for their effectiveness, and even small lapses in use can increase the risk of unintended pregnancy. Second, SARC methods may not be as effective for women who have difficulty remembering to take their medication daily or who experience side effects from hormonal contraception.

The study also found that regional variations were significantly associated with percentage of unintended pregnancies. The Latin America/Caribbean region displayed the strongest association with the outcome, followed by Asia. The Oceania and Europe region had weaker associations. These findings suggest that there are significant contextual factors that influence the percentage of unintended pregnancies across different regions. These factors may include access to healthcare services, legal barriers to access, and cultural attitudes towards contraception. Additionally, regions with cultural or religious restrictions on contraception use may also have higher percetanges of unintended pregnancy.

The study found that marital status was inversely associated with the percentage of unintended pregnancies. As the percent of women who are currently married increases, the percentage of unintended pregnancies decreases. There are some reasonable explanations for this finding. First, married women may have better access to healthcare services and family planning programs than unmarried women. Secondly, married couples may be more likely to plan their pregnancies than unmarried couples. Third, unmarried women may be more likely to have multiple sexual partners who could be opposed to using contraception.

Future research directions could include conducting qualitative studies to better understand the reasons why women choose SARC methods and the challenges they face in using them effectively. Additionally, we suggest that a longitudinal study should be conducted to track changes in the percentage of unintended pregnancies over time and to evaluate the effectiveness of different interventions aimed at reducing unintended pregnancy.


{{< pagebreak >}}

# References

[@heviaLegalStatusEmergency2012], [@jonathanmarcbearakCountryspecificEstimatesUnintended2022], [@kavanaughContraceptiveMethodUse2018], [@rivetContraceptionUseAttitudes2021]





